\subsection{State-space diagnostics}
\label{sec:erpda}
\subsubsection{Error growth without assimilation}

Before examining the error in the ensemble when observations are assimilated, it is useful to examine how the ensemble in our assimilation system spreads relative to the true state when no observations are assimilated, because this shows us what information can actually be gained from assimilating.
Figure \ref{fig:NODA}(a) compares the  mean square error  between the ensemble mean and the true state (MSE hereafter) to the  variance of the ensemble after it has been scaled by $(N+1)/N$, as in (\ref{eq:EvsS}).
The first row shows MSE and ensemble variance for the zonal wind, as a function of vertical level and time, averaging zonally and meridionally.  
The second row of plots compares the MSE and the scaled ensemble spread in the surface pressure, over latitude and time, averaging zonally.  

For the zonal wind, both the error and the ensemble variance begin to grow first around 250 hPa, which is near the altitudes of the extratropical jets.
The growth of the scaled ensemble variance here is largely commensurate with the growth of the MSE.
\textcolor{unsure}{The relative agreement between the growth of the true error and the ensemble spread isn't surprising, since in our case the``truth'' is actually a realization of the same model that produced the ensemble.}

At the surface (Fig. \ref{fig:NODA}b-c) error growth happens first at high latitudes, especially in the Northern Hemisphere.
Here the scaled ensemble variance somewhat underestimates the MSE.
\textcolor{alert}{Do we have an explanation for this?  Or are they "close enough"? -- check after comparing to rank histograms.}

The error in the zonal wind field also becomes underestimated after abount a month, when the ensemble mean MSE shows large errors at the highest model levels (near the ``sponge'' layer, see Section \ref{sec:CAM}), which is not captured by the ensemble variance.
\textcolor{alert}{Again, need an explanation for this.}

As stated in the introduction, the goal of ensemble assimilation is to generate an ensemble that captures the true uncertainty in the estimated state, given the observations, which also means that the true state should, be a sample of the PDF represented by the ensemble.
To test whether our ensemble achieves this, we construct a rank histogram.

Figure \ref{fig:RH_basic}a shows the rank histogram for surface pressure in the NODA experiment, counting of all points in the model grid, and assimilation days 10-20. 
It is slightly concave, indicating that the true state is somewhat more likely to be lower or higher than all ensemble members.
This means that the ensemble spread in this experiment is somewhat too small, \textcolor{unsure}{but by and large the truth can still be considered a sample of the ensemble}.  
\textcolor{alert}{Need to verify that the RH for zonal and meridional wind is qualitatively similar.}

In order for the assimilation experiments of the next section to be successful, they should achieve two goals: (1) to decrease the true error, and (2) to maintain an ensemble that is as or more representative of the true error as in the NoDA experiment.

\subsubsection{Assimilation of AAM}

Figure \ref{fig:RH_basic}b shows the surface pressure rank histogram for experiment AAM, i.e. after assimilating the three global excitation function (**)-(**).  
Clearly, the assimilation has made the rank histogram much more concave; the truth is now a very frequent outlier of the PDF represented by the ensemble. 


Figure \ref{fig:ERPALL_error_growth}a-b shows the MSE and scaled ensemble variance in the surface pressure, as in Fig. \ref{fig:NODA}b-c, but for the AAM DA experiment. 
Figure \ref{fig:ERPALL_error_growth}c-d shows the difference in MSE and scaled ensemble variance between AAM DA and No DA (positive values indicating larger values in AAM DA).  
When the AAM components are assimilated, MSE (Fig. \ref{fig:ERPALL_error_growth}a) grows more or less as in the No DA case (Fig. \ref{fig:NODA}c), but the difference between then (Fig. \ref{fig:ERPALL_error_growth}c) shows that the assimilation has decreased the error in some places, and increased it in others.
In contrast, the ensemble variance (Figure \ref{fig:ERPALL_error_growth}b,d) has decreased everywhere when the AAM components are assimilated.  




\subsection{Evolution of the  Covariance Field}

It was seen above that the ensemble filter is able to update the state more or less correctly at the beginning of the assimilation, actually makes the error between the ensemble mean and the true state worse later on in the assimilation period.
The degree to which each variable field is changed as the assimilation progresses depends on the covariances between local variables (in our case, winds or surface pressure) and the global AAM functions (\ref{eq:covariance}).
The covariance $c_{x_iy}$ is estimated for each state variable $x_i$ and each observation $y$ by the statistics of the model ensemble.  
A point in the model state can have a large covariance with the global AAM either if it has a large variance, or if it has a large correlation to the global AAM, or both.

